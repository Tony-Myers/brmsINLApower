% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/engine-two-stage.R
\name{brms_inla_power_two_stage}
\alias{brms_inla_power_two_stage}
\title{Two-Stage Bayesian Assurance Simulation}
\usage{
brms_inla_power_two_stage(
  formula,
  effect_name,
  effect_range,
  n_range,
  stage1_k_effects = 7,
  stage1_k_n = 8,
  stage1_nsims = 100,
  stage2_nsims = 400,
  refine_metric = c("direction", "threshold", "rope"),
  refine_target = 0.8,
  prob_threshold = 0.95,
  effect_threshold = 0,
  obs_per_group = NULL,
  error_sd = NULL,
  group_sd = 0.5,
  band = 0.06,
  expand = 1L,
  ...
)
}
\arguments{
\item{formula}{Model formula.}

\item{effect_name}{Name of fixed effect to assess.}

\item{effect_range}{Numeric length-2 vector for effect size range.}

\item{n_range}{Numeric length-2 vector for sample size range.}

\item{stage1_k_effects}{Effects in Stage 1 grid (default 7).}

\item{stage1_k_n}{Sample sizes in Stage 1 grid (default 8).}

\item{stage1_nsims}{Sims per cell in Stage 1 (default 100).}

\item{stage2_nsims}{Sims per cell in Stage 2 (default 400).}

\item{refine_metric}{Metric to refine on: "direction", "threshold", or "rope".}

\item{refine_target}{Target assurance value to refine around (default 0.8).}

\item{prob_threshold}{Posterior prob. threshold for decisions.}

\item{effect_threshold}{Effect size threshold for "threshold" rules.}

\item{obs_per_group}{Observations per group for generator.}

\item{error_sd}{Residual SD for Gaussian-like families.}

\item{group_sd}{SD for random effects in generator.}

\item{band}{Bandwidth around target for candidate cells (default 0.06).}

\item{expand}{Expand radius in grid steps (default 1).}

\item{...}{Additional arguments passed to \code{\link{brms_inla_power}}.}
}
\value{
List with elements:
\describe{
\item{results}{Combined Stage 1 and Stage 2 simulation results.}
\item{summary}{Aggregated metrics per cell.}
\item{stage1}{Stage 1 grid info.}
\item{stage2}{Stage 2 grid info.}
\item{params}{Refinement parameters.}
}
}
\description{
Runs a two-stage assurance / power simulation using \code{\link{brms_inla_power}}.
Stage 1 does a coarse grid search over \code{effect_range} and \code{n_range}.
Stage 2 refines the search near the target assurance band.
}
